# TINY-ML-for-FOC-of-PMSM-20092024
<!--- PI(D) output correction using Tiny NN

Permanent Magnet Synchronous Motors (PMSMs) are highly efficient, fast rotating, and reliable brushless motors, making them ideal for high-performance applications like electric vehicles, industrial robots, and machine tools. Despite their advantages, PMSM control remains a challenging area of research, particularly during abrupt speed transitions. Traditional Filed oriented control (PID-based) methods for plant linearization have shown limited success, and while Non-Linear Model Predictive Control (NLMPC) is theoretically optimal, its complexity makes on-device implementation impractical. This research project done in System Research and Development with Danilo Pau (danilo.pau@st.com) focuses on improving PMSM control by integrating a tiny neural network with a PI(D) controller to enhance speed tracking performance. The neural network, developed and integrated in the Simulink model, corrects the reference quadrature current, mitigating overshoots and undershoots during speed transitions. After training, the model is optimized in Matlab (hyper parameter optimization, pruning) for deployment on STM32 and Stellar-E families of micro-controllers by using the ST Edge AI Unified Core Technology https://www.st.com/en/development-tools/stedgeai-core.html integrated into the ST Edge AI Developer Cloud https://stm32ai-cs.st.com/home , to allow automated and optimal deployment thus ensuring it is suitable for real-time application with minimal computational and memory overhead. Future work will explore replacing the dual PI(D) controllers with a single neural network to directly output reference voltages, further advancing PMSM control strategies.  -->
The deployment of neural networks on resource-constrained micro-controllers has gained momentum, driving many advancements in Tiny Neural Networks. This paper introduces a tiny feed-forward neural network, TinyFC, integrated into the Field-Oriented Control (FOC) of Permanent Magnet Synchronous Motors (PMSMs). Proportional-Integral (PI) controllers are widely used in FOC for their simplicity, although their limitations in handling nonlinear dynamics hinder precision. To address this issue, a lightweight 1,400 parameters TinyFC was devised to enhance the FOC performance while fitting into the computational and memory constraints of a micro-controller. Advanced optimization techniques, including pruning, hyperparameter tuning, and quantization to 8-bit integers, were applied to reduce the model's footprint while preserving the network effectiveness. Simulation results show the proposed approach significantly reduced overshoot by up to 87.5\%, with the pruned model achieving complete overshoot elimination, highlighting the potential of tiny neural networks in real-time motor control applications.
![alt text](https://github.com/heixiaopengyou/TINY-ML-for-FOC-of-PMSM-20092024/blob/main/Pruned-model-results-case1.png)
